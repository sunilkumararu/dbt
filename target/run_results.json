{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.4", "generated_at": "2024-07-31T04:09:04.596243Z", "invocation_id": "12e190c3-ed42-47c7-a713-f74ba891d4f0", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-31T04:09:04.546948Z", "completed_at": "2024-07-31T04:09:04.557819Z"}, {"name": "execute", "started_at": "2024-07-31T04:09:04.558728Z", "completed_at": "2024-07-31T04:09:04.558813Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01319432258605957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.postgres_dbt1.customers", "compiled": true, "compiled_code": "-- models/staging/customers.sql\n\nselect\n    customer_id,\n    first_name,\n    last_name,\n    email,\n    sign_up_date\nfrom \"ilufzqee\".\"public\".\"raw_customers\"", "relation_name": "\"ilufzqee\".\"public\".\"customers\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-31T04:09:04.561559Z", "completed_at": "2024-07-31T04:09:04.565335Z"}, {"name": "execute", "started_at": "2024-07-31T04:09:04.565798Z", "completed_at": "2024-07-31T04:09:04.565812Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005331754684448242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.postgres_dbt1.orders", "compiled": true, "compiled_code": "-- models/staging/orders.sql\n\nselect\n    order_id,\n    customer_id,\n    product_id,\n    order_date,\n    quantity,\n    total_amount\nfrom \"ilufzqee\".\"public\".\"raw_orders\"", "relation_name": "\"ilufzqee\".\"public\".\"orders\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-31T04:09:04.568939Z", "completed_at": "2024-07-31T04:09:04.576503Z"}, {"name": "execute", "started_at": "2024-07-31T04:09:04.577086Z", "completed_at": "2024-07-31T04:09:04.577098Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009845256805419922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.postgres_dbt1.products", "compiled": true, "compiled_code": "-- models/staging/products.sql\n\nselect\n    product_id,\n    product_name,\n    category,\n    price\nfrom \"ilufzqee\".\"public\".\"raw_products\"", "relation_name": "\"ilufzqee\".\"public\".\"products\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-31T04:09:04.580694Z", "completed_at": "2024-07-31T04:09:04.582314Z"}, {"name": "execute", "started_at": "2024-07-31T04:09:04.582770Z", "completed_at": "2024-07-31T04:09:04.582782Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003855466842651367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.postgres_dbt1.sample", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-31T04:09:04.585587Z", "completed_at": "2024-07-31T04:09:04.592600Z"}, {"name": "execute", "started_at": "2024-07-31T04:09:04.593167Z", "completed_at": "2024-07-31T04:09:04.593180Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00887155532836914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.postgres_dbt1.customer_order_summary", "compiled": true, "compiled_code": "-- models/marts/customer_order_summary.sql\n\n-- CTE to get raw order data with product and customer details\nwith raw_order_data as (\n    select\n        o.order_id,\n        o.customer_id,\n        c.first_name,\n        c.last_name,\n        c.email,\n        c.sign_up_date,\n        o.product_id,\n        p.product_name,\n        p.category,\n        o.order_date,\n        o.quantity,\n        o.total_amount\n    from \"ilufzqee\".\"public\".\"orders\" o\n    join \"ilufzqee\".\"public\".\"customers\" c on o.customer_id = c.customer_id\n    join \"ilufzqee\".\"public\".\"products\" p on o.product_id = p.product_id\n),\n\n-- CTE to calculate order statistics\norder_stats as (\n    select\n        customer_id,\n        count(order_id) as total_orders,\n        sum(quantity) as total_quantity,\n        sum(total_amount) as total_spent,\n        min(order_date) as first_order_date,\n        max(order_date) as last_order_date\n    from raw_order_data\n    group by customer_id\n),\n\n-- CTE to determine the favorite product and category\nfavorite_product_category as (\n    select\n        customer_id,\n        product_name as favorite_product,\n        category as favorite_category\n    from (\n        select\n            customer_id,\n            product_name,\n            category,\n            row_number() over(partition by customer_id order by sum(total_amount) desc) as rnk\n        from raw_order_data\n        group by customer_id, product_name, category\n    ) ranked\n    where rnk = 1\n)\n\n-- Final select statement to combine everything into the summary table\nselect\n    c.customer_id,\n    concat(c.first_name, ' ', c.last_name) as customer_name,\n    c.email,\n    c.sign_up_date,\n    os.total_orders,\n    os.total_quantity,\n    os.total_spent,\n    os.first_order_date,\n    os.last_order_date,\n    fp.favorite_product,\n    fp.favorite_category\nfrom order_stats os\njoin \"ilufzqee\".\"public\".\"customers\" c on os.customer_id = c.customer_id\nleft join favorite_product_category fp on os.customer_id = fp.customer_id", "relation_name": "\"ilufzqee\".\"public\".\"customer_order_summary\""}], "elapsed_time": 3.364643096923828, "args": {"show_resource_report": false, "favor_state": false, "use_colors_file": true, "partial_parse_file_diff": true, "cache_selected_only": false, "which": "compile", "write_json": true, "exclude": [], "log_file_max_bytes": 10485760, "inject_ephemeral_ctes": true, "use_colors": true, "indirect_selection": "eager", "vars": {}, "require_explicit_package_overrides_for_builtin_materializations": true, "profiles_dir": "/b6efabd9-2002-48db-a121-010c9b5bc836/dbt", "output": "text", "log_level_file": "debug", "printer_width": 80, "source_freshness_run_project_hooks": false, "version_check": true, "print": true, "send_anonymous_usage_stats": true, "defer": false, "populate_cache": true, "strict_mode": false, "enable_legacy_logger": false, "log_level": "info", "warn_error_options": {"include": [], "exclude": []}, "invocation_command": "dbt compile", "partial_parse": true, "macro_debugging": false, "introspect": true, "log_format": "default", "require_resource_names_without_spaces": false, "select": [], "empty": false, "quiet": false, "static_parser": true, "log_format_file": "debug", "project_dir": "/b6efabd9-2002-48db-a121-010c9b5bc836/dbt", "log_path": "/b6efabd9-2002-48db-a121-010c9b5bc836/dbt/logs"}}