{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.4", "generated_at": "2024-08-01T05:19:36.204508Z", "invocation_id": "7f3e1efd-1cf4-42b2-bbef-d3b0d19865e4", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-01T05:19:36.155565Z", "completed_at": "2024-08-01T05:19:36.168762Z"}, {"name": "execute", "started_at": "2024-08-01T05:19:36.169930Z", "completed_at": "2024-08-01T05:19:36.169955Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.016116857528686523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.postgres_dbt1.customers", "compiled": true, "compiled_code": "-- models/staging/customers.sql\n\nselect\n    customer_id,\n    first_name,\n    last_name,\n    email,\n    sign_up_date\nfrom \"ilufzqee\".\"public\".\"raw_customers\"", "relation_name": "\"ilufzqee\".\"public\".\"customers\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-01T05:19:36.174948Z", "completed_at": "2024-08-01T05:19:36.178571Z"}, {"name": "execute", "started_at": "2024-08-01T05:19:36.179116Z", "completed_at": "2024-08-01T05:19:36.179131Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0053937435150146484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.postgres_dbt1.orders", "compiled": true, "compiled_code": "-- models/staging/orders.sql\n\nselect\n    order_id,\n    customer_id,\n    product_id,\n    order_date,\n    quantity,\n    total_amount\nfrom \"ilufzqee\".\"public\".\"raw_orders\"", "relation_name": "\"ilufzqee\".\"public\".\"orders\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-01T05:19:36.182262Z", "completed_at": "2024-08-01T05:19:36.188225Z"}, {"name": "execute", "started_at": "2024-08-01T05:19:36.189053Z", "completed_at": "2024-08-01T05:19:36.189066Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008022546768188477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.postgres_dbt1.products", "compiled": true, "compiled_code": "-- models/staging/products.sql\n\nselect\n    product_id,\n    product_name,\n    category,\n    price\nfrom \"ilufzqee\".\"public\".\"raw_products\"", "relation_name": "\"ilufzqee\".\"public\".\"products\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-01T05:19:36.191715Z", "completed_at": "2024-08-01T05:19:36.193361Z"}, {"name": "execute", "started_at": "2024-08-01T05:19:36.193935Z", "completed_at": "2024-08-01T05:19:36.193947Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0035474300384521484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.postgres_dbt1.sample", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-01T05:19:36.196455Z", "completed_at": "2024-08-01T05:19:36.201417Z"}, {"name": "execute", "started_at": "2024-08-01T05:19:36.201870Z", "completed_at": "2024-08-01T05:19:36.201881Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006498575210571289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.postgres_dbt1.customer_order_summary", "compiled": true, "compiled_code": "-- models/marts/customer_order_summary.sql\n\n-- CTE to get raw order data with product and customer details\nwith raw_order_data as (\n    select\n        o.order_id,\n        o.customer_id,\n        c.first_name,\n        c.last_name,\n        c.email,\n        c.sign_up_date,\n        o.product_id,\n        p.product_name,\n        p.category,\n        o.order_date,\n        o.quantity,\n        o.total_amount\n    from \"ilufzqee\".\"public\".\"orders\" o\n    join \"ilufzqee\".\"public\".\"customers\" c on o.customer_id = c.customer_id\n    join \"ilufzqee\".\"public\".\"products\" p on o.product_id = p.product_id\n),\n\n-- CTE to calculate order statistics\norder_stats as (\n    select\n        customer_id,\n        count(order_id) as total_orders,\n        sum(quantity) as total_quantity,\n        sum(total_amount) as total_spent,\n        min(order_date) as first_order_date,\n        max(order_date) as last_order_date\n    from raw_order_data\n    group by customer_id\n),\n\n-- CTE to determine the favorite product and category\nfavorite_product_category as (\n    select\n        customer_id,\n        product_name as favorite_product,\n        category as favorite_category\n    from (\n        select\n            customer_id,\n            product_name,\n            category,\n            row_number() over(partition by customer_id order by sum(total_amount) desc) as rnk\n        from raw_order_data\n        group by customer_id, product_name, category\n    ) ranked\n    where rnk = 1\n)\n\n-- Final select statement to combine everything into the summary table\nselect\n    c.customer_id,\n    concat(c.first_name, ' ', c.last_name) as customer_name,\n    c.email,\n    c.sign_up_date,\n    os.total_orders,\n    os.total_quantity,\n    os.total_spent,\n    os.first_order_date,\n    os.last_order_date,\n    fp.favorite_product,\n    fp.favorite_category\nfrom order_stats os\njoin \"ilufzqee\".\"public\".\"customers\" c on os.customer_id = c.customer_id\nleft join favorite_product_category fp on os.customer_id = fp.customer_id", "relation_name": "\"ilufzqee\".\"public\".\"customer_order_summary\""}], "elapsed_time": 3.234043598175049, "args": {"strict_mode": false, "populate_cache": true, "use_colors": true, "write_json": true, "log_format": "default", "quiet": false, "project_dir": "/b6efabd9-2002-48db-a121-010c9b5bc836/dbt", "exclude": [], "enable_legacy_logger": false, "log_file_max_bytes": 10485760, "macro_debugging": false, "use_colors_file": true, "inject_ephemeral_ctes": true, "log_level": "info", "partial_parse": true, "output": "text", "invocation_command": "dbt compile", "introspect": true, "defer": false, "profiles_dir": "/b6efabd9-2002-48db-a121-010c9b5bc836/dbt", "favor_state": false, "which": "compile", "log_path": "/b6efabd9-2002-48db-a121-010c9b5bc836/dbt/logs", "require_explicit_package_overrides_for_builtin_materializations": true, "show_resource_report": false, "cache_selected_only": false, "source_freshness_run_project_hooks": false, "log_format_file": "debug", "send_anonymous_usage_stats": true, "partial_parse_file_diff": true, "empty": false, "require_resource_names_without_spaces": false, "print": true, "version_check": true, "select": [], "log_level_file": "debug", "printer_width": 80, "warn_error_options": {"include": [], "exclude": []}, "static_parser": true, "vars": {}, "indirect_selection": "eager"}}